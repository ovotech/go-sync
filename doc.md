<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# ports

```go
import "github.com/ovotech/go-sync/pkg/ports"
```

Package ports lists the types of methods expected from Sync's standard adapters.

## Index

- [type Adapter](<#type-adapter>)


## type Adapter

Adapter interfaces are used to allow Sync to communicate with third party services.

```go
type Adapter interface {
    Get(ctx context.Context) ([]string, error) // Get users in a service.
    Add(context.Context, []string) error       // Add users to a service.
    Remove(context.Context, []string) error    // Remove users from a service.
}
```

# sync

```go
import "github.com/ovotech/go-sync/pkg/sync"
```

Package sync provides a way to synchronise membership of arbitrary services.

## Index

- [type Sync](<#type-sync>)
  - [func New(source ports.Adapter, optsFn ...func(*Sync)) *Sync](<#func-new>)
  - [func (s *Sync) SyncWith(ctx context.Context, adapter ports.Adapter) error](<#func-sync-syncwith>)


## type Sync

```go
type Sync struct {
    DryRun bool // Flag to indicate if running in dryRun mode.
    Add    bool // Flag to indicate if Sync should add accounts.
    Remove bool // Flag to indicate if Sync should remove accounts.
    // contains filtered or unexported fields
}
```

### func New

```go
func New(source ports.Adapter, optsFn ...func(*Sync)) *Sync
```

New creates a new Sync service.

### func \(\*Sync\) SyncWith

```go
func (s *Sync) SyncWith(ctx context.Context, adapter ports.Adapter) error
```

SyncWith synchronises the requested service with the source service, adding & removing members.

# team

```go
import "github.com/ovotech/go-sync/pkg/adapters/github/team"
```

## Index

- [type GitHubDiscovery](<#type-githubdiscovery>)
- [type Team](<#type-team>)
  - [func New(client *github.Client, discovery GitHubDiscovery, org string, slug string, optsFn ...func(*Team)) *Team](<#func-new>)
  - [func (t *Team) Add(ctx context.Context, emails []string) error](<#func-team-add>)
  - [func (t *Team) Get(ctx context.Context) ([]string, error)](<#func-team-get>)
  - [func (t *Team) Remove(ctx context.Context, emails []string) error](<#func-team-remove>)


## type GitHubDiscovery

GitHubDiscovery is required because there are multiple ways to convert a GitHub email into a username. At OVO we use SAML, but other organisations may use public emails or another mechanism.

```go
type GitHubDiscovery interface {
    GetUsernameFromEmail(context.Context, []string) ([]string, error)
    GetEmailFromUsername(context.Context, []string) ([]string, error)
}
```

## type Team

```go
type Team struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *github.Client, discovery GitHubDiscovery, org string, slug string, optsFn ...func(*Team)) *Team
```

New instantiates a new GitHub Team adapter.

### func \(\*Team\) Add

```go
func (t *Team) Add(ctx context.Context, emails []string) error
```

Add emails to a GitHub Team.

### func \(\*Team\) Get

```go
func (t *Team) Get(ctx context.Context) ([]string, error)
```

Get a list of emails in a GitHub team.

### func \(\*Team\) Remove

```go
func (t *Team) Remove(ctx context.Context, emails []string) error
```

Remove a list of emails from a GitHub team.

# conversation

```go
import "github.com/ovotech/go-sync/pkg/adapters/slack/conversation"
```

## Index

- [Variables](<#variables>)
- [type Conversation](<#type-conversation>)
  - [func New(client *slack.Client, channelName string, optsFn ...func(conversation *Conversation)) *Conversation](<#func-new>)
  - [func (c *Conversation) Add(_ context.Context, emails []string) error](<#func-conversation-add>)
  - [func (c *Conversation) Get(_ context.Context) ([]string, error)](<#func-conversation-get>)
  - [func (c *Conversation) Remove(_ context.Context, emails ...string) error](<#func-conversation-remove>)


## Variables

```go
var ErrCacheEmpty = errors.New("cache is empty - run Get()")
```

## type Conversation

```go
type Conversation struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *slack.Client, channelName string, optsFn ...func(conversation *Conversation)) *Conversation
```

New instantiates a new Slack conversation adapter.

### func \(\*Conversation\) Add

```go
func (c *Conversation) Add(_ context.Context, emails []string) error
```

Add adds an email to a conversation.

### func \(\*Conversation\) Get

```go
func (c *Conversation) Get(_ context.Context) ([]string, error)
```

Get gets a list of emails from a Slack channel.

### func \(\*Conversation\) Remove

```go
func (c *Conversation) Remove(_ context.Context, emails ...string) error
```

Remove removes email addresses from a conversation.

# usergroup

```go
import "github.com/ovotech/go-sync/pkg/adapters/slack/usergroup"
```

## Index

- [Variables](<#variables>)
- [type UserGroup](<#type-usergroup>)
  - [func New(slackClient *slack.Client, userGroup string, optsFn ...func(group *UserGroup)) *UserGroup](<#func-new>)
  - [func (u *UserGroup) Add(_ context.Context, emails []string) error](<#func-usergroup-add>)
  - [func (u *UserGroup) Get(_ context.Context) ([]string, error)](<#func-usergroup-get>)
  - [func (u *UserGroup) Remove(_ context.Context, emails []string) error](<#func-usergroup-remove>)


## Variables

```go
var ErrCacheEmpty = errors.New("cache is empty - run Get()")
```

## type UserGroup

```go
type UserGroup struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(slackClient *slack.Client, userGroup string, optsFn ...func(group *UserGroup)) *UserGroup
```

New instantiates a new Slack UserGroup adapter.

### func \(\*UserGroup\) Add

```go
func (u *UserGroup) Add(_ context.Context, emails []string) error
```

Add a list of emails to a Slack UserGroup. Since the Slack API takes all of this as a single request, it either returns a full list of successful emails, or an error.

### func \(\*UserGroup\) Get

```go
func (u *UserGroup) Get(_ context.Context) ([]string, error)
```

Get a list of email addresses in a Slack User Group.

### func \(\*UserGroup\) Remove

```go
func (u *UserGroup) Remove(_ context.Context, emails []string) error
```

Remove a list of email addresses from a Slack UserGroup.

# saml

```go
import "github.com/ovotech/go-sync/pkg/adapters/github/discovery/saml"
```

## Index

- [Variables](<#variables>)
- [type Saml](<#type-saml>)
  - [func New(client *githubv4.Client, org string, optsFn ...func(*Saml)) *Saml](<#func-new>)
  - [func (s *Saml) GetEmailFromUsername(ctx context.Context, logins []string) ([]string, error)](<#func-saml-getemailfromusername>)
  - [func (s *Saml) GetUsernameFromEmail(ctx context.Context, emails []string) ([]string, error)](<#func-saml-getusernamefromemail>)


## Variables

ErrUserNotFound is returned when the SAML \-\> GitHub username mapping cannot be found.

```go
var ErrUserNotFound = errors.New("user_not_found")
```

## type Saml

```go
type Saml struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *githubv4.Client, org string, optsFn ...func(*Saml)) *Saml
```

New instantiates a new GitHub SAML discovery adapter for use with GitHub adapters.

### func \(\*Saml\) GetEmailFromUsername

```go
func (s *Saml) GetEmailFromUsername(ctx context.Context, logins []string) ([]string, error)
```

GetEmailFromUsername takes a list of GitHub usernames, and returns a list of emails.

### func \(\*Saml\) GetUsernameFromEmail

```go
func (s *Saml) GetUsernameFromEmail(ctx context.Context, emails []string) ([]string, error)
```

GetUsernameFromEmail takes a list of email addresses, and returns a list of equivalent GitHub usernames.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
