<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# ports

```go
import "github.com/ovotech/go-sync/pkg/ports"
```

Package ports lists the types of methods expected from Sync's adapters.

## Index

- [type Adapter](<#type-adapter>)
- [type Sync](<#type-sync>)


## type Adapter

Adapter interfaces are used to allow Sync to communicate with third party services.

```go
type Adapter interface {
    Get(ctx context.Context) ([]string, error) // Get things in a service.
    Add(context.Context, []string) error       // Add things to a service.
    Remove(context.Context, []string) error    // Remove things from a service.
}
```

## type Sync

The Sync interface can be used for downstream services that implement Sync in your own workflow.

```go
type Sync interface {
    SyncWith(ctx context.Context, adapter Adapter) error // Sync the things in a source service with this service.
}
```

# sync

```go
import "github.com/ovotech/go-sync/pkg/sync"
```

Package sync is the logic that synchronises adapters together, and determines what should be where.

## Index

- [func OptionLogger(logger types.Logger) func(*Sync)](<#func-optionlogger>)
- [type Sync](<#type-sync>)
  - [func New(source ports.Adapter, optsFn ...func(*Sync)) *Sync](<#func-new>)
  - [func (s *Sync) SyncWith(ctx context.Context, adapter ports.Adapter) error](<#func-sync-syncwith>)


## func OptionLogger

```go
func OptionLogger(logger types.Logger) func(*Sync)
```

OptionLogger can be used to set a custom logger.

## type Sync

```go
type Sync struct {
    DryRun bool // DryRun mode calculates membership, but doesn't add or remove.
    Add    bool // Perform Add operations.
    Remove bool // Perform Remove operations.
    // contains filtered or unexported fields
}
```

### func New

```go
func New(source ports.Adapter, optsFn ...func(*Sync)) *Sync
```

New creates a new Sync service.

### func \(\*Sync\) SyncWith

```go
func (s *Sync) SyncWith(ctx context.Context, adapter ports.Adapter) error
```

SyncWith synchronises the destination service with the source service, adding & removing things as necessary.

# team

```go
import "github.com/ovotech/go-sync/pkg/adapters/github/team"
```

Package team synchronises emails with GitHub teams.

You must provide a discovery service in order to use this adapter. This is because converting email addresses to GitHub usernames isn't straightforward. At OVO, we enforce SAML for our GitHub users, and have provided a SAML \-\> GitHub Username discovery service, but you may need to write your own.

## Index

- [func OptionLogger(logger types.Logger) func(*Team)](<#func-optionlogger>)
- [type GitHubDiscovery](<#type-githubdiscovery>)
- [type Team](<#type-team>)
  - [func New(client *github.Client, discovery GitHubDiscovery, org string, slug string, optsFn ...func(*Team)) *Team](<#func-new>)
  - [func (t *Team) Add(ctx context.Context, emails []string) error](<#func-team-add>)
  - [func (t *Team) Get(ctx context.Context) ([]string, error)](<#func-team-get>)
  - [func (t *Team) Remove(ctx context.Context, emails []string) error](<#func-team-remove>)


## func OptionLogger

```go
func OptionLogger(logger types.Logger) func(*Team)
```

OptionLogger can be used to set a custom logger.

## type GitHubDiscovery

GitHubDiscovery is required because there are multiple ways to convert a GitHub email into a username. At OVO we use SAML, but other organisations may use public emails or another mechanism.

```go
type GitHubDiscovery interface {
    GetUsernameFromEmail(context.Context, []string) ([]string, error)
    GetEmailFromUsername(context.Context, []string) ([]string, error)
}
```

## type Team

```go
type Team struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *github.Client, discovery GitHubDiscovery, org string, slug string, optsFn ...func(*Team)) *Team
```

New instantiates a new GitHub Team adapter.

### func \(\*Team\) Add

```go
func (t *Team) Add(ctx context.Context, emails []string) error
```

Add emails to a GitHub Team.

### func \(\*Team\) Get

```go
func (t *Team) Get(ctx context.Context) ([]string, error)
```

Get emails of users in a GitHub team.

### func \(\*Team\) Remove

```go
func (t *Team) Remove(ctx context.Context, emails []string) error
```

Remove emails from a GitHub team.

# conversation

```go
import "github.com/ovotech/go-sync/pkg/adapters/slack/conversation"
```

Package conversation synchronises email addresses with Slack conversations.

In order to use this adapter, you'll need an authenticated Slack client and for the Slack app to have been added to the conversation.

## Index

- [Variables](<#variables>)
- [func OptionLogger(logger types.Logger) func(*Conversation)](<#func-optionlogger>)
- [type Conversation](<#type-conversation>)
  - [func New(client *slack.Client, channelName string, optsFn ...func(conversation *Conversation)) *Conversation](<#func-new>)
  - [func (c *Conversation) Add(_ context.Context, emails []string) error](<#func-conversation-add>)
  - [func (c *Conversation) Get(_ context.Context) ([]string, error)](<#func-conversation-get>)
  - [func (c *Conversation) Remove(_ context.Context, emails []string) error](<#func-conversation-remove>)


## Variables

ErrCacheEmpty shouldn't realistically be raised unless the adapter is being used outside of Go Sync.

```go
var ErrCacheEmpty = errors.New("cache is empty - run Get()")
```

## func OptionLogger

```go
func OptionLogger(logger types.Logger) func(*Conversation)
```

OptionLogger can be used to set a custom logger.

## type Conversation

```go
type Conversation struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *slack.Client, channelName string, optsFn ...func(conversation *Conversation)) *Conversation
```

New instantiates a new Slack conversation adapter.

### func \(\*Conversation\) Add

```go
func (c *Conversation) Add(_ context.Context, emails []string) error
```

Add emails to a Slack conversation.

### func \(\*Conversation\) Get

```go
func (c *Conversation) Get(_ context.Context) ([]string, error)
```

Get emails of Slack users in a conversation.

### func \(\*Conversation\) Remove

```go
func (c *Conversation) Remove(_ context.Context, emails []string) error
```

Remove emails from a Slack conversation.

# usergroup

```go
import "github.com/ovotech/go-sync/pkg/adapters/slack/usergroup"
```

Package usergroup synchronises emails with a Slack UserGroup.

In order to use this adapter, you'll need an authenticated Slack client and the ID of the usergroup. This isn't particularly easy to find, you'll need to log in to Slack via a web browser, and navigate to \`People & User Groups\`. Find your User group, and the URL will contain the ID of the group.

## Index

- [Variables](<#variables>)
- [func OptionLogger(logger types.Logger) func(*UserGroup)](<#func-optionlogger>)
- [type UserGroup](<#type-usergroup>)
  - [func New(slackClient *slack.Client, userGroup string, optsFn ...func(group *UserGroup)) *UserGroup](<#func-new>)
  - [func (u *UserGroup) Add(_ context.Context, emails []string) error](<#func-usergroup-add>)
  - [func (u *UserGroup) Get(_ context.Context) ([]string, error)](<#func-usergroup-get>)
  - [func (u *UserGroup) Remove(_ context.Context, emails []string) error](<#func-usergroup-remove>)


## Variables

ErrCacheEmpty shouldn't realistically be raised unless the adapter is being used outside of Go Sync.

```go
var ErrCacheEmpty = errors.New("cache is empty - run Get()")
```

## func OptionLogger

```go
func OptionLogger(logger types.Logger) func(*UserGroup)
```

OptionLogger can be used to set a custom logger.

## type UserGroup

```go
type UserGroup struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(slackClient *slack.Client, userGroup string, optsFn ...func(group *UserGroup)) *UserGroup
```

New instantiates a new Slack UserGroup adapter.

### func \(\*UserGroup\) Add

```go
func (u *UserGroup) Add(_ context.Context, emails []string) error
```

Add emails to a Slack User group.

### func \(\*UserGroup\) Get

```go
func (u *UserGroup) Get(_ context.Context) ([]string, error)
```

Get emails of Slack users in a User group.

### func \(\*UserGroup\) Remove

```go
func (u *UserGroup) Remove(_ context.Context, emails []string) error
```

Remove emails from a Slack User group.

# saml

```go
import "github.com/ovotech/go-sync/pkg/adapters/github/discovery/saml"
```

## Index

- [Variables](<#variables>)
- [type Saml](<#type-saml>)
  - [func New(client *githubv4.Client, org string, optsFn ...func(*Saml)) *Saml](<#func-new>)
  - [func (s *Saml) GetEmailFromUsername(ctx context.Context, logins []string) ([]string, error)](<#func-saml-getemailfromusername>)
  - [func (s *Saml) GetUsernameFromEmail(ctx context.Context, emails []string) ([]string, error)](<#func-saml-getusernamefromemail>)


## Variables

ErrUserNotFound is returned when the SAML \-\> GitHub username mapping cannot be found.

```go
var ErrUserNotFound = errors.New("user_not_found")
```

## type Saml

```go
type Saml struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(client *githubv4.Client, org string, optsFn ...func(*Saml)) *Saml
```

New instantiates a new GitHub SAML discovery adapter for use with GitHub adapters.

### func \(\*Saml\) GetEmailFromUsername

```go
func (s *Saml) GetEmailFromUsername(ctx context.Context, logins []string) ([]string, error)
```

GetEmailFromUsername takes a list of GitHub usernames, and returns a list of emails.

### func \(\*Saml\) GetUsernameFromEmail

```go
func (s *Saml) GetUsernameFromEmail(ctx context.Context, emails []string) ([]string, error)
```

GetUsernameFromEmail takes a list of email addresses, and returns a list of equivalent GitHub usernames.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
